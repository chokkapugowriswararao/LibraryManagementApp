<!DOCTYPE html>
{% extends "index.html" %}
{% load static %}

{% block main_content %}
<div class="container-flex text-center justify-content-center align-items-center" style="padding-top: 10px; padding-bottom: 20px; margin-top: 10px;">
  <!-- Header Row -->
  <div class="row justify-content-center align-middle" style="margin-top: 10px; height: 60px;">
    <div class="col-md-4 text-light" style="background-color: #4B088A;">
      <h4 style="margin-top: 15px;">Register new user</h4>
    </div>
    <div class="col-md-8">
      <h4>Search User</h4>
    </div>
  </div>

  <div class="row">
    <!-- Left: Register Form -->
    <div class="col-md-4">
      <div class="container shadow p-3 mb-5 bg-body rounded" style="overflow-y: auto; height: 600px; background: #CEECF5;">
        <form class="d-flex flex-column" action="{% url 'readers_tab' %}" method="POST">
          {% csrf_token %}
          <table class="table table-borderless" style="margin-top: 20px;">
            <tr>
              <td style="text-align: left; padding-left: 15px;">Name:</td>
              <td><input type="text" class="form-control" name="reader_name" required /></td>
            </tr>
            <tr>
              <td style="text-align: left; padding-left: 15px;">Contact:</td>
              <td><input type="text" class="form-control" name="reader_contact" required /></td>
            </tr>
            <tr>
              <td style="text-align: left; padding-left: 15px;">Reference ID:</td>
              <td><input type="text" class="form-control" name="referece_id" required /></td>
            </tr>
            <tr>
              <td style="text-align: left; padding-left: 15px;">Address:</td>
              <td><textarea class="form-control" name="reader_address" required></textarea></td>
            </tr>
            <tr>
              <td colspan="2" class="text-center">
                <button class="btn btn-success btn-lg shadow" type="submit">Save</button>
              </td>
            </tr>
          </table>
        </form>

        <ul class="mt-3 text-start px-3">
          <li><small>Readers should not Register multiple times</small></li>
          <li><small>Duplicate Reader Registrations will be deactivated</small></li>
          <li><small>Contact information provided above must be correct and subject to verification</small></li>
        </ul>
      </div>
    </div>

    <!-- Right: Search + Results -->
    <div class="col-md-8">
      <!-- Search Bar -->
      <div class="row">
        <nav class="navbar bg-body-light">
          <div class="container-fluid justify-content-center align-items-center">
            <form class="d-flex" method="GET" action="{% url 'readers_tab' %}">
              <input class="form-control me-2" type="search" placeholder="Search by name/contact/ref ID" name="search" value="{{ search_query }}" />
              <button class="btn btn-outline-primary me-2" type="submit">Search</button>
            </form>
          </div>
        </nav>
      </div>

      <!-- Reader List -->
      <div class="row mt-3">
        <p><strong>{{ readers|length }}</strong> reader{{ readers|length|pluralize }} subscribed.</p>

        <div class="table-responsive shadow rounded">
          <table class="table table-striped table-hover table-bordered align-middle mb-0">
            <thead class="table-primary text-center">
              <tr>
                <th>Name</th>
                <th>Contact</th>
                <th>Reference ID</th>
                <th>Address</th>
              </tr>
            </thead>
            <tbody>
              {% for r in readers %}
                <tr class="text-center">
                  <td>{{ r.reader_name }}</td>
                  <td>{{ r.reader_contact }}</td>
                  <td>{{ r.referece_id }}</td>
                  <td>{{ r.reader_address }}</td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan="4" class="text-center text-danger">No readers found.</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- Clear Button at Footer -->
        {% if search_query %}
        <div class="d-flex justify-content-end mt-3">
          <a href="{% url 'readers_tab' %}" class="btn btn-warning shadow">Clear Search</a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
